;WITH CTE1 AS (SELECT TOP(1000) ID FROM [WSO2MetricsDb].[dbo].[METRIC_GAUGE] WHERE TIMESTAMP < (SELECT DATEDIFF_BIG(millisecond, '1970-01-01 00:00:00',  Dateadd(day, -180, GETUTCDATE()))) ORDER BY ID ASC)
DELETE MG FROM [WSO2MetricsDb].[dbo].[METRIC_GAUGE] MG INNER JOIN CTE1 ON MG.ID = CTE1.ID;


;WITH CTE2 AS (SELECT TOP(1000) ID FROM [WSO2MetricsDb].[dbo].[METRIC_TIMER] WHERE TIMESTAMP < (SELECT DATEDIFF_BIG(millisecond, '1970-01-01 00:00:00',  Dateadd(day, -180, GETUTCDATE()))) ORDER BY ID ASC)
DELETE MG FROM [WSO2MetricsDb].[dbo].[METRIC_TIMER] MG INNER JOIN CTE2 ON MG.ID = CTE2.ID;