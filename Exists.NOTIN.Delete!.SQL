DELETE FROM TMP
WHERE EXISTS
(SELECT * FROM TMP T2 WHERE T2.PROSPECTID=TMP.PROSPECTID AND T2.ROWID!=TMP.ROWID AND T2.PRIORITY<TMP.PRIORITY)


-- IN OPERATOR SLOW DOWN THE QUERY

DELETE FROM TMP WHERE ROWID IN
(SELECT T1.ROWID FROM TMP T1 
WHERE EXISTS
(SELECT * FROM TMP T2 WHERE T2.PROSPECTID=T1.PROSPECTID AND T2.ROWID!=T1.ROWID AND T2.PRIORITY<T1.PRIORITY)
)



--- NOT IN 
AND RTRIM(CAST(S.SurvPID AS VARCHAR))+'-'+RTRIM((CAST(P.FileID AS VARCHAR))) NOT IN (SELECT RTRIM(CAST(ProspectID AS VARCHAR))+'-'+RTRIM((CAST(FileID AS VARCHAR))) FROM ProspectPool.dbo.Suppressions)