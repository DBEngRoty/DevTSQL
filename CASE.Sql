(SELECT 
(CASE WHEN RSM_ID> 0 THEN 1 ELSE 0 END) AS RSM_ID,
(CASE WHEN DSE_ID> 0 THEN 1 ELSE 0 END) AS DSE_ID,
(CASE WHEN APP_ID> 0 THEN 1 ELSE 0 END) AS APP_ID,
(CASE WHEN CS_ID> 0 THEN 1 ELSE 0 END) AS CS_ID
INTO tmpa
FROM PROSPECT)


-- OR
SELECT  FLAG_RSMPLUS, (CASE WHEN FLAG_RSMPLUS=1 THEN 'T' ELSE 'F' END) AS RSM1PLUS FROM RSMCUSTOMER



-- Counting
SELECT 
SUM (CASE WHEN LEN(MatchDetails) > 0 THEN 1 ELSE 0 END) AS MATCHED,
SUM (CASE WHEN LEN(MatchDetails) = 0 THEN 1 ELSE 0 END) AS NON_MATCHED
FROM Dealers_Upload_BMO_201907;



-- Pivot
SELECT
AN AS ANUL
SUM(CASE TRIMESTRU WHEN 1 THEN SALES ELSE NULL END) AS TR1,
SUM(CASE TRIMESTRU WHEN 2 THEN SALES ELSE NULL END) AS TR2,
SUM(CASE TRIMESTRU WHEN 3 THEN SALES ELSE NULL END) AS TR3,
SUM(CASE TRIMESTRU WHEN 4 THEN SALES ELSE NULL END) AS TR4,
SUM(SALES) AS TOTAL
FROM ANUALSALES
GROUP BY AN
------ END PIVOT --------

-- UPDATE
UPDATE StoreDb.dbo.TU_Output SET
TUPIN = (CASE WHEN LEN(TUPIN)=0 THEN NULL ELSE TUPIN END),
AA12 = (CASE WHEN LEN(AA12)=0 THEN NULL ELSE AA12 END),
ScreenCode = (CASE WHEN LEN(ScreenCode)=0 THEN NULL ELSE ScreenCode END);

-- Diferente de data time
SELECT 
(CASE WHEN ISNULL(DATEDIFF(DAY,'1900-01-01',DATA1),0) > ISNULL(DATEDIFF(DAY,'1900-01-01',DATA2),0) THEN DATA2
	  WHEN ISNULL(DATEDIFF(DAY,'1900-01-01',DATA1),0) < ISNULL(DATEDIFF(DAY,'1900-01-01',DATA2),0) THEN DATA1
	ELSE NULL END)
FROM dbo.Table1



-- Incapsulat!!!
SET @vCMD = '  UPDATE P SET 
P.Q_CorrectStatus			= S.Q_CorrectStatus,
P.Flag_AddressError			= (CASE WHEN S.Q_CorrectStatus IN ('+'''N'''+','+'''O'''+') THEN 1 ELSE 0 END)

  FROM CustomerPool.dbo.Customer P, RES_CustomerInfo_Stage  S
  WHERE  P.Customer_ID = S.Customer_ID '
--PRINT @vcmd
EXEC (@vcmd)